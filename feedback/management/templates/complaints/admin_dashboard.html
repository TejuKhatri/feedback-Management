{% extends "base.html" %}
{% block title %}Admin Dashboard{% endblock %}
{% block content %}

<div class="card">
  <h2 class="h1">Admin Dashboard</h2>
  <p class="muted">Monitor all complaints and manage resolution.</p>

  <div class="grid">
    <div class="card">
      <h3>Total Complaints</h3>
      <p class="h1">{{ total }}</p>
    </div>
    <div class="card">
      <h3>Open</h3>
      <p class="h1">{{ open_count }}</p>
      <a class="btn btn-light" href="{% url 'admin_complaints' %}?status=open">View</a>
    </div>
    <div class="card">
      <h3>In Progress</h3>
      <p class="h1">{{ progress_count }}</p>
      <a class="btn btn-light" href="{% url 'admin_complaints' %}?status=in_progress">View</a>
    </div>
    <div class="card">
      <h3>Resolved</h3>
      <p class="h1">{{ resolved_count }}</p>
      <a class="btn btn-light" href="{% url 'admin_complaints' %}?status=resolved">View</a>
    </div>
  </div>

  <div class="card" style="margin-top:14px;">
    <h3 style="margin:0 0 10px;">Latest Complaints</h3>
    <table class="table">
      <thead>
        <tr>
          <th>ID</th>
          <th>User</th>
          <th>Title</th>
          <th>Status</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        {% for c in latest %}
          <tr>
            <td>{{ c.id }}</td>
            <td>{{ c.user.username }}</td>
            <td>{{ c.title }}</td>
            <td><span class="pill {{ c.status }}">{{ c.get_status_display }}</span></td>
            <td><a class="btn btn-green" href="{% url 'admin_update_complaint' c.id %}">Open</a></td>
          </tr>
        {% empty %}
          <tr><td colspan="5">No complaints found.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>

{% endblock %}
